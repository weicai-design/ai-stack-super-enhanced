<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½å·¥ä½œè®¡åˆ’ç®¡ç† - AI-STACK</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/confirmation.css">
    <style>
        .workplan-container { max-width: 1280px; margin: 0 auto; padding: 24px; }
        .workplan-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .workplan-header h2 { margin: 0; font-size: 26px; font-weight: 600; }
        .workplan-actions { display: flex; gap: 12px; }
        .workplan-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
        .stat-card { background: var(--bg-primary); border-radius: var(--radius-md); padding: 16px; border: 1px solid var(--border-color); }
        .stat-label { font-size: 14px; color: var(--text-secondary); }
        .stat-label.sub { font-size: 12px; margin-top: 6px; display: block; }
        .stat-value { font-size: 26px; font-weight: 600; color: var(--text-primary); }
        .workplan-filters { display: flex; gap: 12px; margin-bottom: 24px; padding: 16px; background: var(--bg-secondary); border-radius: var(--radius-md); }
        .filter-group { display: flex; align-items: center; gap: 8px; }
        .filter-group select, .filter-group input { padding: 6px 12px; border: 1px solid var(--border-color); border-radius: var(--radius-sm); font-size: 14px; }
        .workplan-main { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; }
        .plans-list { display: flex; flex-direction: column; gap: 16px; }
        .plan-card { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 20px; transition: all 0.2s; cursor: pointer; }
        .plan-card.active { border-color: var(--primary-color); box-shadow: var(--shadow-lg); }
        .plan-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; gap: 12px; }
        .plan-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary); }
        .plan-meta { display: flex; flex-wrap: wrap; gap: 12px; font-size: 13px; color: var(--text-secondary); }
        .plan-actions { display: flex; gap: 8px; }
        .plan-status { padding: 4px 12px; border-radius: var(--radius-sm); font-size: 12px; font-weight: 600; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-confirmed { background: #d4edda; color: #155724; }
        .status-executing { background: #cce5ff; color: #004085; }
        .status-completed { background: #d1ecf1; color: #0c5460; }
        .plan-progress { height: 6px; border-radius: 999px; background: var(--bg-secondary); overflow: hidden; margin: 12px 0; }
        .plan-progress .bar { height: 100%; background: var(--primary-color); }
        .plan-detail-panel { background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 20px; min-height: 400px; position: sticky; top: 24px; }
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .panel-status { font-size: 13px; padding: 4px 10px; border-radius: var(--radius-sm); background: var(--bg-secondary); }
        .panel-body h4 { margin-top: 20px; margin-bottom: 10px; font-size: 15px; }
        .task-summary-list { display: flex; flex-direction: column; gap: 10px; }
        .task-summary-item { background: var(--bg-secondary); border-radius: var(--radius-sm); padding: 10px 12px; font-size: 13px; }
        .empty-placeholder { text-align: center; color: var(--text-secondary); padding: 24px; }
        .btn { padding: 8px 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color); font-size: 14px; cursor: pointer; transition: all 0.2s; }
        .btn-primary { background: var(--primary-color); color: #fff; border-color: var(--primary-color); }
        .btn-primary:hover { background: var(--primary-color-hover); }
        .btn-secondary { background: var(--bg-secondary); color: var(--text-primary); }
        .btn-danger { background: var(--danger-color); color: #fff; border-color: var(--danger-color); }
        .plan-dialog, .plan-detail-dialog { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.45); align-items: center; justify-content: center; z-index: 1000; }
        .plan-dialog.show, .plan-detail-dialog.show { display: flex; }
        .plan-dialog-content, .plan-detail-content { background: var(--bg-primary); border-radius: var(--radius-lg); padding: 24px; width: min(680px, 95vw); max-height: 85vh; overflow-y: auto; }
        .dialog-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .dialog-close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-secondary); }
        .form-group { margin-bottom: 16px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; }
        .task-selector { max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-sm); padding: 8px; background: var(--bg-secondary); }
        .task-selector label { display: flex; align-items: center; gap: 8px; font-weight: 400; padding: 6px 8px; border-radius: var(--radius-sm); }
        .task-selector label:hover { background: rgba(0,0,0,0.05); }
        .form-actions { display: flex; justify-content: flex-end; gap: 12px; }
        @media (max-width: 992px) { .workplan-main { grid-template-columns: 1fr; } .workplan-stats { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body class="workplan-page" data-workplan="true">
    <div class="workplan-container" id="workplan-root">
        <div class="workplan-header">
            <h2>ğŸ“‹ æ™ºèƒ½å·¥ä½œè®¡åˆ’ç®¡ç†</h2>
            <div class="workplan-actions">
                <button class="btn btn-primary" data-action="open-create-plan">â• æ–°å»ºè®¡åˆ’</button>
                <button class="btn btn-secondary" data-action="refresh-plans">ğŸ”„ åˆ·æ–°</button>
            </div>
        </div>
        <div class="workplan-stats" id="workplan-stats">
            <div class="stat-card">
                <div class="stat-label">æ€»è®¡åˆ’æ•°</div>
                <div class="stat-value" id="total-plans">0</div>
                <div class="stat-label sub">æ´»è·ƒè®¡åˆ’ <span id="active-plans">0</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å¾…ç¡®è®¤è®¡åˆ’</div>
                <div class="stat-value" id="pending-plans">0</div>
                <div class="stat-label sub">å¾…ç¡®è®¤ä»»åŠ¡ <span id="pending-tasks-stat">0</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">æ‰§è¡Œä¸­è®¡åˆ’</div>
                <div class="stat-value" id="executing-plans">0</div>
                <div class="stat-label sub">è¿›è¡Œä¸­ä»»åŠ¡ <span id="in-progress-tasks">0</span></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å·²å®Œæˆè®¡åˆ’</div>
                <div class="stat-value" id="completed-plans">0</div>
                <div class="stat-label sub">ä»»åŠ¡å®Œæˆç‡ <span id="task-completion-rate">0%</span></div>
            </div>
        </div>
        <div class="workplan-filters">
            <div class="filter-group">
                <label>çŠ¶æ€:</label>
                <select id="status-filter" data-filter="status">
                    <option value="">å…¨éƒ¨</option>
                    <option value="pending">å¾…ç¡®è®¤</option>
                    <option value="confirmed">å·²ç¡®è®¤</option>
                    <option value="executing">æ‰§è¡Œä¸­</option>
                    <option value="completed">å·²å®Œæˆ</option>
                </select>
            </div>
            <div class="filter-group">
                <label>åˆ†ç±»:</label>
                <select id="category-filter" data-filter="category">
                    <option value="">å…¨éƒ¨</option>
                    <option value="work">å·¥ä½œ</option>
                    <option value="personal">ä¸ªäºº</option>
                    <option value="project">é¡¹ç›®</option>
                    <option value="other">å…¶ä»–</option>
                </select>
            </div>
            <div class="filter-group">
                <label>æœç´¢:</label>
                <input type="text" id="search-input" placeholder="æœç´¢è®¡åˆ’..." data-filter="search">
            </div>
        </div>
        <div class="workplan-main">
            <div class="plans-list" id="plans-list">
                <div class="empty-placeholder">æš‚æ— å·¥ä½œè®¡åˆ’ï¼Œç‚¹å‡»â€œæ–°å»ºè®¡åˆ’â€ç«‹å³ç”Ÿæˆã€‚</div>
            </div>
            <aside class="plan-detail-panel" id="plan-detail-panel">
                <div class="panel-header">
                    <h3 id="detail-title">é€‰æ‹©ä¸€ä¸ªè®¡åˆ’æŸ¥çœ‹è¯¦æƒ…</h3>
                    <span class="panel-status" id="detail-status"></span>
                </div>
                <div class="panel-body" id="detail-body">
                    <p class="empty-placeholder">è®¡åˆ’è¯¦æƒ…å°†åœ¨æ­¤å±•ç¤ºï¼ŒåŒ…æ‹¬ä»»åŠ¡åˆ—è¡¨ã€å…³é”®è·¯å¾„å’Œå»ºè®®ã€‚</p>
                </div>
            </aside>
        </div>
    </div>
    <div class="plan-dialog" id="plan-dialog">
        <div class="plan-dialog-content">
            <div class="dialog-header">
                <h3 id="dialog-title">æ–°å»ºå·¥ä½œè®¡åˆ’</h3>
                <button class="dialog-close" data-action="close-plan-dialog">Ã—</button>
            </div>
            <form id="plan-form">
                <input type="hidden" id="plan-id" value="">
                <div class="form-group">
                    <label>è®¡åˆ’æ ‡é¢˜ *</label>
                    <input type="text" id="plan-title" required>
                </div>
                <div class="form-group">
                    <label>åˆ†ç±»</label>
                    <select id="plan-category">
                        <option value="work">å·¥ä½œ</option>
                        <option value="personal">ä¸ªäºº</option>
                        <option value="project">é¡¹ç›®</option>
                        <option value="other">å…¶ä»–</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>æè¿°</label>
                    <textarea id="plan-description"></textarea>
                </div>
                <div class="form-group">
                    <label>ä¼˜å…ˆçº§</label>
                    <select id="plan-priority">
                        <option value="low">ä½</option>
                        <option value="medium" selected>ä¸­</option>
                        <option value="high">é«˜</option>
                        <option value="urgent">ç´§æ€¥</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>é€‰æ‹©ä»»åŠ¡</label>
                    <div class="task-selector" id="task-options">
                        <div class="loading">æ­£åœ¨åŠ è½½ä»»åŠ¡...</div>
                    </div>
                    <small>æœªé€‰æ‹©æ—¶å°†è‡ªåŠ¨çº³å…¥æ‰€æœ‰å¾…ç¡®è®¤/å·²ç¡®è®¤ä»»åŠ¡ã€‚</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" data-action="close-plan-dialog">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>
    <div class="plan-detail-dialog" id="plan-detail-dialog">
        <div class="plan-detail-content">
            <div class="dialog-header">
                <h3 id="detail-dialog-title">è®¡åˆ’è¯¦æƒ…</h3>
                <button class="dialog-close" data-action="close-detail-dialog">Ã—</button>
            </div>
            <div class="dialog-body" id="detail-dialog-body"></div>
        </div>
    </div>
    <script src="js/modal.js"></script>
    <script src="js/confirmation.js"></script>
    <script src="js/task.js"></script>
</body>
</html>
