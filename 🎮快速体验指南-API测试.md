# ğŸ® AI Stack API å¿«é€Ÿä½“éªŒæŒ‡å—

**æœåŠ¡åœ°å€**: http://localhost:8000  
**APIæ–‡æ¡£**: http://localhost:8000/docs  
**å½“å‰æ—¶é—´**: 2025-11-08 23:55

---

## ğŸš€ ç«‹å³å¼€å§‹

### æµè§ˆå™¨å·²æ‰“å¼€ï¼

APIäº¤äº’å¼æ–‡æ¡£åº”è¯¥å·²ç»åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­æ‰“å¼€äº†ï¼š
- **åœ°å€**: http://localhost:8000/docs
- **åŠŸèƒ½**: å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•æ‰€æœ‰API

å¦‚æœæ²¡æœ‰è‡ªåŠ¨æ‰“å¼€ï¼Œè¯·æ‰‹åŠ¨è®¿é—®ï¼šhttp://localhost:8000/docs

---

## ğŸ¯ å¿«é€Ÿæµ‹è¯•ç¤ºä¾‹

### 1. å¥åº·æ£€æŸ¥ï¼ˆæœ€ç®€å•ï¼‰âœ…

#### åœ¨æµè§ˆå™¨APIæ–‡æ¡£ä¸­ï¼š
1. æ‰¾åˆ° `GET /health` ç«¯ç‚¹
2. ç‚¹å‡»å±•å¼€
3. ç‚¹å‡» "Try it out"
4. ç‚¹å‡» "Execute"
5. æŸ¥çœ‹å“åº”

#### å‘½ä»¤è¡Œæµ‹è¯•ï¼š
```bash
curl http://localhost:8000/health
```

**é¢„æœŸå“åº”**:
```json
{
  "status": "healthy",
  "service": "RAG & Knowledge Graph",
  "version": "1.0.0"
}
```

---

### 2. RAGæœç´¢ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰ğŸ”

#### åœ¨æµè§ˆå™¨APIæ–‡æ¡£ä¸­ï¼š
1. æ‰¾åˆ° `POST /rag/search` ç«¯ç‚¹
2. ç‚¹å‡» "Try it out"
3. ä¿®æ”¹è¯·æ±‚ä½“ï¼š
```json
{
  "query": "äººå·¥æ™ºèƒ½",
  "top_k": 5
}
```
4. ç‚¹å‡» "Execute"
5. æŸ¥çœ‹æœç´¢ç»“æœ

#### å‘½ä»¤è¡Œæµ‹è¯•ï¼š
```bash
curl -X POST http://localhost:8000/rag/search \
  -H "Content-Type: application/json" \
  -d '{
    "query": "äººå·¥æ™ºèƒ½",
    "top_k": 5
  }'
```

---

### 3. ä¸Šä¼ æ–‡æ¡£ï¼ˆæ•°æ®å¯¼å…¥ï¼‰ğŸ“„

#### åœ¨æµè§ˆå™¨APIæ–‡æ¡£ä¸­ï¼š
1. æ‰¾åˆ° `POST /upload` ç«¯ç‚¹
2. ç‚¹å‡» "Try it out"
3. é€‰æ‹©ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ˆæˆ–åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼‰
4. ç‚¹å‡» "Execute"
5. æŸ¥çœ‹ä¸Šä¼ ç»“æœ

#### åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼š
```bash
echo "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æ¡£ï¼Œç”¨äºAI Stackçš„RAGç³»ç»Ÿæµ‹è¯•ã€‚" > /tmp/test_doc.txt
```

#### å‘½ä»¤è¡Œæµ‹è¯•ï¼š
```bash
curl -X POST http://localhost:8000/upload \
  -F "file=@/tmp/test_doc.txt"
```

---

### 4. çŸ¥è¯†å›¾è°±æŸ¥è¯¢ğŸ•¸ï¸

#### åœ¨æµè§ˆå™¨APIæ–‡æ¡£ä¸­ï¼š
1. æ‰¾åˆ° `GET /kg/entities` ç«¯ç‚¹
2. ç‚¹å‡» "Try it out"
3. ç‚¹å‡» "Execute"
4. æŸ¥çœ‹çŸ¥è¯†å›¾è°±å®ä½“åˆ—è¡¨

#### å‘½ä»¤è¡Œæµ‹è¯•ï¼š
```bash
curl http://localhost:8000/kg/entities
```

---

### 5. åˆ—å‡ºæ‰€æœ‰æ–‡æ¡£ğŸ“š

#### åœ¨æµè§ˆå™¨APIæ–‡æ¡£ä¸­ï¼š
1. æ‰¾åˆ° `GET /docs` ç«¯ç‚¹
2. ç‚¹å‡» "Try it out"
3. ç‚¹å‡» "Execute"
4. æŸ¥çœ‹æ‰€æœ‰å·²ç´¢å¼•çš„æ–‡æ¡£

#### å‘½ä»¤è¡Œæµ‹è¯•ï¼š
```bash
curl http://localhost:8000/docs
```

---

## ğŸ¨ APIæ–‡æ¡£ç•Œé¢è¯´æ˜

### ä¸»è¦åŒºåŸŸ

1. **ç«¯ç‚¹åˆ—è¡¨**ï¼ˆå·¦ä¾§/ä¸Šæ–¹ï¼‰
   - æŒ‰åŠŸèƒ½åˆ†ç»„
   - é¢œè‰²æ ‡è¯†æ–¹æ³•ï¼ˆGETç»¿è‰²ï¼ŒPOSTè“è‰²ï¼ŒDELETEçº¢è‰²ï¼‰

2. **ç«¯ç‚¹è¯¦æƒ…**ï¼ˆç‚¹å‡»å±•å¼€ï¼‰
   - æè¿°
   - å‚æ•°è¯´æ˜
   - è¯·æ±‚ç¤ºä¾‹
   - å“åº”ç¤ºä¾‹

3. **"Try it out"æŒ‰é’®**
   - ç‚¹å‡»åå¯ä»¥ç¼–è¾‘å‚æ•°
   - å®æ—¶æµ‹è¯•API

4. **"Execute"æŒ‰é’®**
   - å‘é€è¯·æ±‚
   - æ˜¾ç¤ºå“åº”

---

## ğŸ“‹ å®Œæ•´ç«¯ç‚¹åˆ—è¡¨

### æ ¸å¿ƒåŠŸèƒ½

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|------|------|------|
| `/health` | GET | å¥åº·æ£€æŸ¥ |
| `/` | GET | æœåŠ¡ä¿¡æ¯ |
| `/docs` | GET | æ–‡æ¡£åˆ—è¡¨ |
| `/upload` | POST | ä¸Šä¼ æ–‡æ¡£ |

### RAGåŠŸèƒ½

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|------|------|------|
| `/rag/search` | POST | è¯­ä¹‰æœç´¢ |
| `/rag/qa` | POST | é—®ç­” |
| `/rag/index` | POST | åˆ›å»ºç´¢å¼• |

### çŸ¥è¯†å›¾è°±

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|------|------|------|
| `/kg/entities` | GET | å®ä½“åˆ—è¡¨ |
| `/kg/relations` | GET | å…³ç³»åˆ—è¡¨ |
| `/kg/query` | POST | å›¾æŸ¥è¯¢ |
| `/kg/add` | POST | æ·»åŠ ä¸‰å…ƒç»„ |

### é«˜çº§åŠŸèƒ½

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|------|------|------|
| `/expert/ask` | POST | ä¸“å®¶å’¨è¯¢ |
| `/selfrag/query` | POST | Self-RAGæŸ¥è¯¢ |
| `/agentic/execute` | POST | Agentæ‰§è¡Œ |

---

## ğŸ§ª æ¨èæµ‹è¯•æµç¨‹

### åˆæ¬¡ä½“éªŒï¼ˆ5åˆ†é’Ÿï¼‰

1. **å¥åº·æ£€æŸ¥** â†’ ç¡®è®¤æœåŠ¡æ­£å¸¸
2. **æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨** â†’ äº†è§£ç°æœ‰æ•°æ®
3. **ä¸Šä¼ æµ‹è¯•æ–‡æ¡£** â†’ ä½“éªŒæ•°æ®å¯¼å…¥
4. **RAGæœç´¢** â†’ æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
5. **çŸ¥è¯†å›¾è°±æŸ¥è¯¢** â†’ æ¢ç´¢å›¾æ•°æ®

### æ·±åº¦ä½“éªŒï¼ˆ30åˆ†é’Ÿï¼‰

1. **æ‰¹é‡ä¸Šä¼ æ–‡æ¡£** â†’ æ„å»ºçŸ¥è¯†åº“
2. **å¤æ‚æŸ¥è¯¢** â†’ æµ‹è¯•æ£€ç´¢èƒ½åŠ›
3. **çŸ¥è¯†å›¾è°±æ„å»º** â†’ æ·»åŠ å®ä½“å…³ç³»
4. **é—®ç­”ç³»ç»Ÿ** â†’ æµ‹è¯•RAG QA
5. **ä¸“å®¶ç³»ç»Ÿ** â†’ ä½“éªŒé«˜çº§åŠŸèƒ½

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### åœ¨APIæ–‡æ¡£ä¸­

1. **AuthorizeåŠŸèƒ½**ï¼ˆå¦‚éœ€è¦ï¼‰
   - ç‚¹å‡»å³ä¸Šè§’"Authorize"
   - è¾“å…¥API Keyï¼ˆå¦‚æœé…ç½®äº†ï¼‰

2. **æŸ¥çœ‹Schema**
   - ç‚¹å‡»"Schemas"æ ‡ç­¾
   - æŸ¥çœ‹æ•°æ®æ¨¡å‹å®šä¹‰

3. **å¤åˆ¶curlå‘½ä»¤**
   - æ‰§è¡ŒAPIå
   - å¤åˆ¶ç”Ÿæˆçš„curlå‘½ä»¤
   - å¯åœ¨ç»ˆç«¯ä¸­é‡å¤ä½¿ç”¨

4. **æŸ¥çœ‹å“åº”**
   - Response bodyï¼šè¿”å›æ•°æ®
   - Response headersï¼šå“åº”å¤´
   - Response codeï¼šçŠ¶æ€ç 

---

## ğŸ¯ å¸¸è§æµ‹è¯•åœºæ™¯

### åœºæ™¯1: æ„å»ºçŸ¥è¯†åº“

```bash
# 1. ä¸Šä¼ æ–‡æ¡£
curl -X POST http://localhost:8000/upload \
  -F "file=@document1.txt"

# 2. åˆ›å»ºç´¢å¼•
curl -X POST http://localhost:8000/rag/index

# 3. æµ‹è¯•æœç´¢
curl -X POST http://localhost:8000/rag/search \
  -H "Content-Type: application/json" \
  -d '{"query": "æµ‹è¯•æŸ¥è¯¢"}'
```

### åœºæ™¯2: çŸ¥è¯†å›¾è°±

```bash
# 1. æ·»åŠ å®ä½“å…³ç³»
curl -X POST http://localhost:8000/kg/add \
  -H "Content-Type: application/json" \
  -d '{
    "head": "äººå·¥æ™ºèƒ½",
    "relation": "åŒ…å«",
    "tail": "æœºå™¨å­¦ä¹ "
  }'

# 2. æŸ¥è¯¢å®ä½“
curl http://localhost:8000/kg/entities

# 3. å›¾æŸ¥è¯¢
curl -X POST http://localhost:8000/kg/query \
  -H "Content-Type: application/json" \
  -d '{"entity": "äººå·¥æ™ºèƒ½"}'
```

### åœºæ™¯3: æ™ºèƒ½é—®ç­”

```bash
# RAGé—®ç­”
curl -X POST http://localhost:8000/rag/qa \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
    "context_size": 3
  }'
```

---

## ğŸ“Š å“åº”çŠ¶æ€ç 

| çŠ¶æ€ç  | å«ä¹‰ | è¯´æ˜ |
|--------|------|------|
| **200** | OK | è¯·æ±‚æˆåŠŸ |
| **201** | Created | èµ„æºåˆ›å»ºæˆåŠŸ |
| **400** | Bad Request | è¯·æ±‚å‚æ•°é”™è¯¯ |
| **401** | Unauthorized | æœªæˆæƒï¼ˆéœ€è¦API Keyï¼‰ |
| **404** | Not Found | èµ„æºä¸å­˜åœ¨ |
| **500** | Server Error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## ğŸ”§ å¼€å‘è€…æ¨¡å¼

### å®æ—¶æŸ¥çœ‹æ—¥å¿—

```bash
# åœ¨æ–°ç»ˆç«¯çª—å£
tail -f logs/app.log
```

### ä¿®æ”¹ä»£ç æµ‹è¯•

ç”±äºå¯ç”¨äº†çƒ­é‡è½½ï¼š
1. ç¼–è¾‘ä»£ç æ–‡ä»¶
2. ä¿å­˜
3. è‡ªåŠ¨é‡è½½ï¼ˆ2-3ç§’ï¼‰
4. åˆ·æ–°APIæ–‡æ¡£æµ‹è¯•

### è°ƒè¯•æŠ€å·§

```bash
# æŸ¥çœ‹è¯¦ç»†å“åº”å¤´
curl -v http://localhost:8000/health

# æ ¼å¼åŒ–JSONè¾“å‡º
curl -s http://localhost:8000/docs | python3 -m json.tool

# æµ‹é‡å“åº”æ—¶é—´
time curl http://localhost:8000/health
```

---

## ğŸ¨ åˆ›å»ºæµ‹è¯•æ•°æ®

### å¿«é€Ÿåˆ›å»ºæµ‹è¯•æ–‡æ¡£

```bash
# åˆ›å»ºæµ‹è¯•ç›®å½•
mkdir -p /tmp/ai_stack_test

# åˆ›å»ºå¤šä¸ªæµ‹è¯•æ–‡æ¡£
cat > /tmp/ai_stack_test/doc1.txt << 'EOF'
äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œè‡´åŠ›äºåˆ›å»ºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡çš„ç³»ç»Ÿã€‚
EOF

cat > /tmp/ai_stack_test/doc2.txt << 'EOF'
æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªå­é›†ï¼Œä½¿è®¡ç®—æœºèƒ½å¤Ÿä»æ•°æ®ä¸­å­¦ä¹ è€Œæ— éœ€æ˜ç¡®ç¼–ç¨‹ã€‚
EOF

cat > /tmp/ai_stack_test/doc3.txt << 'EOF'
æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œä½¿ç”¨å¤šå±‚ç¥ç»ç½‘ç»œæ¥åˆ†æå„ç§å› ç´ ã€‚
EOF

# æ‰¹é‡ä¸Šä¼ 
for file in /tmp/ai_stack_test/*.txt; do
  echo "ä¸Šä¼ : $file"
  curl -X POST http://localhost:8000/upload -F "file=@$file"
  echo ""
done
```

---

## ğŸŒŸ é«˜çº§åŠŸèƒ½ä½“éªŒ

### 1. Smart QAï¼ˆv2.6.0æ–°åŠŸèƒ½ï¼‰

```bash
# æ£€æŸ¥Smart QAå¥åº·çŠ¶æ€
curl http://localhost:8000/smart-qa/health

# å¤šè½®å¯¹è¯
curl -X POST http://localhost:8000/smart-qa/chat \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½",
    "conversation_id": "test-conv-001"
  }'
```

### 2. æºè¿½è¸ª

```bash
# æŸ¥è¯¢æ—¶è·å–æ¥æº
curl -X POST http://localhost:8000/rag/search \
  -H "Content-Type: application/json" \
  -d '{
    "query": "æœºå™¨å­¦ä¹ ",
    "include_sources": true
  }'
```

### 3. ç­”æ¡ˆè´¨é‡è¯„åˆ†

```bash
# è·å–ç­”æ¡ˆåŠè´¨é‡è¯„åˆ†
curl -X POST http://localhost:8000/smart-qa/answer-quality \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ï¼Ÿ",
    "answer": "æ·±åº¦å­¦ä¹ æ˜¯..."
  }'
```

---

## ğŸ“± ç§»åŠ¨ç«¯æµ‹è¯•

å¦‚æœéœ€è¦åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæµ‹è¯•ï¼š

```bash
# è·å–æœ¬æœºIP
ifconfig | grep "inet " | grep -v 127.0.0.1

# ä½¿ç”¨IPåœ°å€è®¿é—®
# ä¾‹å¦‚: http://192.168.1.100:8000/docs
```

---

## ğŸ‰ å¿«é€ŸæˆåŠŸä½“éªŒ

### 3åˆ†é’Ÿå¿«é€ŸéªŒè¯

```bash
# 1. å¥åº·æ£€æŸ¥ï¼ˆ10ç§’ï¼‰
curl http://localhost:8000/health

# 2. åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼ˆ10ç§’ï¼‰
echo "AI Stackæ˜¯ä¸€ä¸ªå¼ºå¤§çš„çŸ¥è¯†ç®¡ç†ç³»ç»Ÿ" > /tmp/quick_test.txt

# 3. ä¸Šä¼ æ–‡æ¡£ï¼ˆ20ç§’ï¼‰
curl -X POST http://localhost:8000/upload -F "file=@/tmp/quick_test.txt"

# 4. æœç´¢æµ‹è¯•ï¼ˆ20ç§’ï¼‰
curl -X POST http://localhost:8000/rag/search \
  -H "Content-Type: application/json" \
  -d '{"query": "çŸ¥è¯†ç®¡ç†"}'

# 5. æŸ¥çœ‹ç»“æœï¼ˆ10ç§’ï¼‰
curl http://localhost:8000/docs
```

**æ€»ç”¨æ—¶**: < 3åˆ†é’Ÿ  
**ç»“æœ**: âœ… å®Œæ•´ä½“éªŒRAGæ ¸å¿ƒåŠŸèƒ½

---

## ğŸ’¬ å¸¸è§é—®é¢˜

### Q: APIè¿”å›404ï¼Ÿ
**A**: æ£€æŸ¥ç«¯ç‚¹è·¯å¾„ï¼Œç¡®ä¿æ–¹æ³•æ­£ç¡®ï¼ˆGET/POSTï¼‰

### Q: å¦‚ä½•ä¸Šä¼ å¤§æ–‡ä»¶ï¼Ÿ
**A**: å½“å‰æ”¯æŒå¸¸è§æ–‡æ¡£æ ¼å¼ï¼Œå¤§å°é™åˆ¶è§é…ç½®

### Q: æœç´¢æ²¡æœ‰ç»“æœï¼Ÿ
**A**: ç¡®ä¿å·²ä¸Šä¼ æ–‡æ¡£å¹¶åˆ›å»ºç´¢å¼•

### Q: å¦‚ä½•åœæ­¢æœåŠ¡ï¼Ÿ
**A**: `pkill -f "uvicorn api.app:app"`

### Q: å¦‚ä½•é‡å¯æœåŠ¡ï¼Ÿ
**A**: å‚è€ƒéƒ¨ç½²æ–‡æ¡£ä¸­çš„é‡å¯å‘½ä»¤

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **ğŸ‰AI-Stackéƒ¨ç½²æˆåŠŸ**: å®Œæ•´éƒ¨ç½²ä¿¡æ¯
- **ğŸ†éƒ¨ç½²å®Œæˆæ€»ç»“**: ä»Šæ—¥æˆæœ
- **ğŸ—ºï¸ä¸‹ä¸€æ­¥å¼€å‘è·¯çº¿å›¾**: æœªæ¥è§„åˆ’

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### ä½“éªŒå®Œæˆå

1. **æä¾›åé¦ˆ**: è®°å½•ä½¿ç”¨ä½“éªŒ
2. **å‘ç°é—®é¢˜**: è®°å½•bugæˆ–æ”¹è¿›ç‚¹
3. **ç»§ç»­å¼€å‘**: å¼€å§‹v2.6.0åŠŸèƒ½é›†æˆ
4. **æ•°æ®å‡†å¤‡**: å‡†å¤‡çœŸå®æ•°æ®æµ‹è¯•

---

## ğŸŒŸ äº«å—æ‚¨çš„AI Stackä¹‹æ—…ï¼

**è®°ä½**:
- ğŸ“– APIæ–‡æ¡£æ˜¯æœ€å¥½çš„æµ‹è¯•å·¥å…·
- ğŸ§ª å¤§èƒ†æµ‹è¯•ï¼Œæ”¯æŒçƒ­é‡è½½
- ğŸ’¡ æœ‰é—®é¢˜éšæ—¶æŸ¥çœ‹æ–‡æ¡£
- ğŸš€ ç»§ç»­å¼€å‘æ–°åŠŸèƒ½

**ç«‹å³å¼€å§‹**: http://localhost:8000/docs â­

---

**ç¥æ‚¨ä½“éªŒæ„‰å¿«ï¼** ğŸŠ

