## P0-102 å…¨å±€é—­ç¯å¼•æ“è½åœ°äº¤ä»˜æ–‡æ¡£

### 1. æ”¹é€ èŒƒå›´
- **ä»»åŠ¡ç³»ç»Ÿ**ï¼š`/tasks/{task_id}/execute` é€šè¿‡ `run_closed_loop_operation` æ‰§è¡Œä»»åŠ¡è®¡åˆ’ã€RAG å†™å›ä¸èµ„æºå½±å“è®°å½•ï¼Œç»Ÿä¸€äº§å‡º `execution_id`ã€‚
- **RAG ç®¡é“**ï¼š`/rag/pipeline/ingest` å°†æ¸…æ´—/æ ‡å‡†åŒ–/å»é‡/æ ¡éªŒ/å…¥åº“å…¨è¿‡ç¨‹çº³å…¥é—­ç¯ï¼Œå¤±è´¥ä¼šå†™å…¥ Unified Event Busã€‚
- **ERP å…¥å£**ï¼š`/erp/trial/calc` è¯•ç®—å™¨ä»¥é—­ç¯æ–¹å¼è¿è¡Œ `_erp_trial_calc_logic`ï¼Œä¿ç•™çœŸå®è¯•ç®—ä¸å†å²å›æº¯ã€‚
- **Trend æŒ‡æ ‡**ï¼š`/trend/backtest` ä½¿ç”¨é—­ç¯è§¦å‘å›æµ‹ä¸æ•°æ®é‡‡é›†ï¼Œå¹¶æŠŠ `X-Execution-ID` å†™å…¥å“åº” Headerã€‚
- **å†…å®¹åˆ†é•œ**ï¼š`/content/storyboard/generate` ä»¥é—­ç¯å°è£…åˆ†é•œç”Ÿæˆé€»è¾‘ï¼Œè¿”å› Response Header ä¾›å‰ç«¯è¿½è¸ªã€‚

### 2. äº‹ä»¶ä¸è¯æ®
- æ‰€æœ‰å…¥å£åœ¨ `accept â†’ execute â†’ check â†’ feedback` é˜¶æ®µå‡è‡ªåŠ¨å†™å…¥ï¼š
  - `artifacts/evidence/`ï¼ˆç”± `EvidenceRecorder` ç»´æŠ¤ï¼Œå«é˜¶æ®µæ•°æ®ã€è€—æ—¶ã€é”™è¯¯å †æ ˆï¼‰ã€‚
  - `unified_event_bus`ï¼ˆäº‹ä»¶ç±»å‹ï¼š`task_accepted` / `execution_started` / `check_completed` / `closed_loop.completed` ç­‰ï¼‰ã€‚
- å¯é€šè¿‡ `/events/unified` è®¢é˜…å™¨æˆ– SQLite `closed_loop_events` è¡¨è¿›è¡Œå®¡è®¡ï¼›æ¯æ¬¡æ‰§è¡Œéƒ½å¸¦ `correlation_id = execution_id`ã€‚

### 3. æ•°æ®æµç¤ºæ„
1. API è°ƒç”¨ `run_closed_loop_operation`ï¼š
   - `ClosedLoopEngine.accept_task` è®°å½•ä»»åŠ¡ã€æ¨¡å—ã€å‡½æ•°ä¸å…¥å‚ã€‚
   - `ClosedLoopEngine.execute` è°ƒç”¨é¢†åŸŸæ‰§è¡Œå™¨å¹¶å†™å…¥æ‰§è¡Œè¯æ®ã€‚
   - `ExecutionChecker` è‡ªåŠ¨è¿è¡Œè§„åˆ™ã€å°†ç»“æœé€å…¥ `FeedbackHandler`ã€‚
   - äº‹ä»¶å¹¿æ’­ + è¯æ®å­˜æ¡£å®Œæˆåè¿”å› `execution_id` ä¸ä¸šåŠ¡æ•°æ®ã€‚
2. ä¸šåŠ¡é€»è¾‘å¯ç»§ç»­æ ¹æ®ç»“æœåšé¢å¤–å¤„ç†ï¼ˆå¦‚ä»»åŠ¡ RAG å†™å›ã€èµ„æºæ—¥å¿—ï¼‰ã€‚

### 4. éªŒè¯ä¸å›æ”¾
- `python3 -m py_compile "ğŸš€ Super Agent Main Interface/api/super_agent_api.py"`ï¼šç¡®ä¿ API å…¥å£è¯­æ³•é€šè¿‡ã€‚
- `python3 scripts/check_dependencies.py`ï¼šç”Ÿæˆ `artifacts/dependency_reports/dependency_report.json`ï¼Œå¯ä½è¯ä¾èµ–å¥åº·çŠ¶å†µã€‚
- é€šè¿‡ `curl` / æµè§ˆå™¨è®¿é—®ï¼š
  - `GET /trend/backtest`ï¼šæ£€æŸ¥å“åº” Header `X-Execution-ID` å¹¶åœ¨ Event Viewer ä¸­æŸ¥è¯¢åŒ ID äº‹ä»¶ã€‚
  - `POST /content/storyboard/generate`ï¼šæŸ¥çœ‹åˆ†é•œç»“æœ + Header ä¸­çš„æ‰§è¡Œ IDã€‚
  - `POST /erp/trial/calc`ï¼šè¿”å›ä½“åŒ…å« `execution_id`ï¼Œå¯åœ¨è¯æ®åº“ä¸­æŸ¥æ‰¾å¯¹åº” JSONã€‚

### 5. åç»­å»ºè®®
1. åœ¨ CI ä¸­æ–°å¢æ­¥éª¤ï¼šè°ƒç”¨ `/tasks/{id}/execute`ã€`/rag/pipeline/ingest` ç­‰å…³é”®è·¯å¾„åï¼Œè‡ªåŠ¨æ”¶é›† `execution_id` å¹¶å°† `artifacts/evidence/<execution_id>.json` ä¸Šä¼ åˆ°éªŒæ”¶ä»“ã€‚
2. ä¸º `ExecutionChecker` å¢åŠ  ERP/å†…å®¹/Trend ä¸“ç”¨è§„åˆ™ï¼Œä»¥ä¾¿åœ¨ CHECK é˜¶æ®µè¿›è¡Œä¸šåŠ¡æŒ‡æ ‡æ ¡éªŒã€‚
3. å°† `run_closed_loop_operation` æ‰©å±•åˆ°æ›´å¤šæ¨¡å—ï¼ˆStockã€Operations & Financeã€AI ç¼–ç¨‹åŠ©æ‰‹ï¼‰å¹¶æä¾›æ‰¹é‡è¿½è¸ª Dashboardã€‚

