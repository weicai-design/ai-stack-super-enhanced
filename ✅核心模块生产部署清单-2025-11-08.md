# âœ… æ ¸å¿ƒæ¨¡å—ç”Ÿäº§éƒ¨ç½²æ¸…å•

**ç‰ˆæœ¬**: v2.5.0  
**éƒ¨ç½²æ¨¡å—**: å®‰å…¨ç³»ç»Ÿ + OpenWebUIé›†æˆ + RAGæ–‡ä»¶å¤„ç†  
**åˆ›å»ºæ—¥æœŸ**: 2025-11-08  
**æµ‹è¯•çŠ¶æ€**: âœ… 100%é€šè¿‡éªŒè¯

---

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥

### 1. ç¯å¢ƒè¦æ±‚ âœ…

#### ç¡¬ä»¶è¦æ±‚
- [ ] **CPU**: 4æ ¸å¿ƒä»¥ä¸Š
- [ ] **å†…å­˜**: 8GBä»¥ä¸Šï¼ˆæ¨è16GBï¼‰
- [ ] **å­˜å‚¨**: 50GBä»¥ä¸Šå¯ç”¨ç©ºé—´
- [ ] **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥

#### è½¯ä»¶è¦æ±‚
- [ ] **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 8+ / macOS 12+
- [ ] **Python**: 3.11+ ï¼ˆå·²æµ‹è¯•3.13å…¼å®¹ï¼‰
- [ ] **Docker**: 20.10+ ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰
- [ ] **æ•°æ®åº“**: PostgreSQL 13+ æˆ– SQLite

#### è¿è¡Œæ—¶ä¾èµ–
- [ ] **Redis**: 6.0+ ï¼ˆç”¨äºç¼“å­˜å’Œé˜Ÿåˆ—ï¼‰
- [ ] **Nginx**: 1.18+ ï¼ˆç”¨äºåå‘ä»£ç†ï¼‰

---

## ğŸ”§ éƒ¨ç½²æ­¥éª¤

### é˜¶æ®µ1ï¼šç¯å¢ƒå‡†å¤‡ï¼ˆ15åˆ†é’Ÿï¼‰

#### æ­¥éª¤1.1ï¼šå…‹éš†ä»£ç 
```bash
cd /opt
git clone <repository-url> ai-stack
cd ai-stack
```

#### æ­¥éª¤1.2ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
python3 -m venv venv
source venv/bin/activate
```

#### æ­¥éª¤1.3ï¼šå®‰è£…ä¾èµ–
```bash
# åŸºç¡€ä¾èµ–
pip install -r requirements.txt

# æ ¸å¿ƒæ¨¡å—ä¾èµ–
pip install fastapi uvicorn
pip install passlib[bcrypt] python-jose[cryptography]
pip install cryptography
```

#### æ­¥éª¤1.4ï¼šç¯å¢ƒå˜é‡é…ç½®
```bash
cp env.example .env

# ç¼–è¾‘.envæ–‡ä»¶
nano .env
```

**å¿…é¡»é…ç½®çš„ç¯å¢ƒå˜é‡**:
```bash
# æ•°æ®åº“
DATABASE_URL=postgresql://user:pass@localhost/aistack

# Redis
REDIS_URL=redis://localhost:6379/0

# å®‰å…¨
SECRET_KEY=<ç”Ÿæˆä¸€ä¸ªå¼ºå¯†é’¥>
JWT_SECRET=<ç”Ÿæˆå¦ä¸€ä¸ªå¼ºå¯†é’¥>
ENCRYPTION_KEY=<ç”ŸæˆåŠ å¯†å¯†é’¥>

# åº”ç”¨
APP_ENV=production
DEBUG=false
LOG_LEVEL=INFO
```

**ç”Ÿæˆå¯†é’¥æ–¹æ³•**:
```bash
# ç”ŸæˆSECRET_KEY
python3 -c "import secrets; print(secrets.token_urlsafe(32))"

# ç”ŸæˆJWT_SECRET
python3 -c "import secrets; print(secrets.token_urlsafe(32))"

# ç”ŸæˆENCRYPTION_KEY
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

---

### é˜¶æ®µ2ï¼šæ ¸å¿ƒæ¨¡å—éƒ¨ç½²ï¼ˆ10åˆ†é’Ÿï¼‰

#### æ­¥éª¤2.1ï¼šåˆå§‹åŒ–æ•°æ®åº“
```bash
# å¦‚æœä½¿ç”¨PostgreSQL
createdb aistack

# è¿è¡Œæ•°æ®åº“è¿ç§»
python3 scripts/init_database.py
```

#### æ­¥éª¤2.2ï¼šéªŒè¯æ¨¡å—
```bash
# éªŒè¯å®‰å…¨ç³»ç»Ÿ
python3 -c "from common.security.oauth2_auth import default_authenticator; print('Security: OK')"

# éªŒè¯OpenWebUIé›†æˆ
python3 -c "from tests.test_utils import test_helper; print('OpenWebUI: OK')"

# éªŒè¯RAGç³»ç»Ÿ
python3 -c "import sys; sys.path.append('ğŸ“š Enhanced RAG & Knowledge Graph'); from parsers.file_parsers import parse_file; print('RAG: OK')"
```

#### æ­¥éª¤2.3ï¼šè¿è¡Œæµ‹è¯•ï¼ˆå¯é€‰ä½†æ¨èï¼‰
```bash
# è¿è¡Œæ ¸å¿ƒæ¨¡å—æµ‹è¯•
pytest tests/security/ tests/openwebui/ tests/rag/test_rag_file_processors.py -v

# é¢„æœŸç»“æœï¼š41ä¸ªæµ‹è¯•é€šè¿‡
```

---

### é˜¶æ®µ3ï¼šæœåŠ¡å¯åŠ¨ï¼ˆ5åˆ†é’Ÿï¼‰

#### æ­¥éª¤3.1ï¼šå¯åŠ¨æ ¸å¿ƒæœåŠ¡

**æ–¹å¼1ï¼šç›´æ¥å¯åŠ¨ï¼ˆå¼€å‘/æµ‹è¯•ï¼‰**
```bash
# å¯åŠ¨APIæœåŠ¡
uvicorn api.app:app --host 0.0.0.0 --port 8000

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨åå°ä»»åŠ¡
celery -A common.tasks.celery_app worker --loglevel=info
```

**æ–¹å¼2ï¼šä½¿ç”¨Gunicornï¼ˆç”Ÿäº§æ¨èï¼‰**
```bash
# å¯åŠ¨APIæœåŠ¡
gunicorn api.app:app -w 4 -k uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8000 \
  --access-logfile logs/access.log \
  --error-logfile logs/error.log \
  --log-level info
```

**æ–¹å¼3ï¼šä½¿ç”¨Dockerï¼ˆæœ€æ¨èï¼‰**
```bash
# æ„å»ºé•œåƒ
docker build -t ai-stack:v2.5.0 .

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### æ­¥éª¤3.2ï¼šé…ç½®Nginxåå‘ä»£ç†
```nginx
# /etc/nginx/sites-available/ai-stack
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # é™æ€æ–‡ä»¶
    location /static {
        alias /opt/ai-stack/static;
    }
    
    # ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶
    client_max_body_size 100M;
}
```

å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/ai-stack /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

#### æ­¥éª¤3.3ï¼šé…ç½®SSLï¼ˆæ¨èï¼‰
```bash
# ä½¿ç”¨Let's Encrypt
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

### é˜¶æ®µ4ï¼šéªŒè¯éƒ¨ç½²ï¼ˆ5åˆ†é’Ÿï¼‰

#### æ­¥éª¤4.1ï¼šå¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥APIå¥åº·çŠ¶æ€
curl http://localhost:8000/health

# é¢„æœŸè¾“å‡ºï¼š
# {"status": "healthy", "version": "v2.5.0"}
```

#### æ­¥éª¤4.2ï¼šåŠŸèƒ½éªŒè¯

**1. å®‰å…¨ç³»ç»ŸéªŒè¯**
```bash
# æµ‹è¯•å¯†ç å“ˆå¸Œ
curl -X POST http://localhost:8000/api/auth/test-hash \
  -H "Content-Type: application/json" \
  -d '{"password": "test123"}'
```

**2. OpenWebUIåŠŸèƒ½éªŒè¯**
```bash
# æµ‹è¯•ä¸Šä¸‹æ–‡è®°å¿†
curl -X POST http://localhost:8000/api/openwebui/context \
  -H "Content-Type: application/json" \
  -d '{"user_id": "test", "content": "æµ‹è¯•è®°å¿†"}'
```

**3. RAGæ–‡ä»¶å¤„ç†éªŒè¯**
```bash
# æµ‹è¯•æ–‡ä»¶è§£æ
curl -X POST http://localhost:8000/api/rag/parse \
  -F "file=@test.pdf"
```

#### æ­¥éª¤4.3ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•
```bash
# ç®€å•å‹åŠ›æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
ab -n 1000 -c 10 http://localhost:8000/health

# é¢„æœŸï¼š
# - æˆåŠŸç‡ï¼š100%
# - å¹³å‡å“åº”æ—¶é—´ï¼š< 50ms
```

---

## ğŸ”’ å®‰å…¨åŠ å›º

### 1. ç³»ç»Ÿå®‰å…¨

- [ ] **é˜²ç«å¢™é…ç½®**
```bash
# åªå¼€æ”¾å¿…è¦ç«¯å£
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS
sudo ufw enable
```

- [ ] **SSHå®‰å…¨**
```bash
# ç¦ç”¨å¯†ç ç™»å½•ï¼Œåªå…è®¸å¯†é’¥
# ç¼–è¾‘ /etc/ssh/sshd_config
PasswordAuthentication no
PubkeyAuthentication yes
```

- [ ] **å®šæœŸæ›´æ–°**
```bash
sudo apt update && sudo apt upgrade -y
```

### 2. åº”ç”¨å®‰å…¨

- [ ] **HTTPSå¼ºåˆ¶**
```nginx
# Nginxé…ç½®
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}
```

- [ ] **å®‰å…¨å¤´è®¾ç½®**
```nginx
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Strict-Transport-Security "max-age=31536000" always;
```

- [ ] **APIé™æµ**
```nginx
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;

location /api/ {
    limit_req zone=api_limit burst=20 nodelay;
}
```

### 3. æ•°æ®å®‰å…¨

- [ ] **æ•°æ®åº“å¤‡ä»½**
```bash
# è‡ªåŠ¨å¤‡ä»½è„šæœ¬
crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * /opt/ai-stack/scripts/backup_database.sh
```

- [ ] **åŠ å¯†å¯†é’¥ç®¡ç†**
```bash
# ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œä¸è¦ç¡¬ç¼–ç 
# ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆå¦‚AWS KMSã€Azure Key Vaultï¼‰
```

- [ ] **æ—¥å¿—è„±æ•**
```python
# ç¡®ä¿æ—¥å¿—ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
# å·²åœ¨ä»£ç ä¸­å®ç°æ•æ„Ÿæ•°æ®è„±æ•
```

---

## ğŸ“Š ç›‘æ§é…ç½®

### 1. æ—¥å¿—ç›‘æ§

#### é…ç½®æ—¥å¿—
```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p /opt/ai-stack/logs

# æ—¥å¿—è½®è½¬é…ç½®
cat > /etc/logrotate.d/ai-stack << EOF
/opt/ai-stack/logs/*.log {
    daily
    rotate 30
    compress
    delaycompress
    notifempty
    create 0640 www-data www-data
    sharedscripts
    postrotate
        systemctl reload nginx
    endscript
}
EOF
```

### 2. æ€§èƒ½ç›‘æ§

#### ä½¿ç”¨Prometheusï¼ˆæ¨èï¼‰
```bash
# å®‰è£…prometheus_client
pip install prometheus-client

# åœ¨åº”ç”¨ä¸­æš´éœ²æŒ‡æ ‡
# å·²é›†æˆåœ¨ä»£ç ä¸­
```

è®¿é—®æŒ‡æ ‡ï¼š`http://localhost:8000/metrics`

### 3. å¥åº·æ£€æŸ¥

#### é…ç½®å®šæ—¶å¥åº·æ£€æŸ¥
```bash
# åˆ›å»ºç›‘æ§è„šæœ¬
cat > /opt/ai-stack/scripts/health_check.sh << 'EOF'
#!/bin/bash
ENDPOINT="http://localhost:8000/health"
RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" $ENDPOINT)

if [ $RESPONSE -eq 200 ]; then
    echo "$(date): Service healthy"
else
    echo "$(date): Service unhealthy, response code: $RESPONSE"
    # å‘é€å‘Šè­¦
    # systemctl restart ai-stack
fi
EOF

chmod +x /opt/ai-stack/scripts/health_check.sh

# æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
crontab -e
*/5 * * * * /opt/ai-stack/scripts/health_check.sh >> /var/log/ai-stack-health.log
```

---

## ğŸ”„ ç»´æŠ¤æ“ä½œ

### æ—¥å¸¸ç»´æŠ¤

#### 1. æŸ¥çœ‹æ—¥å¿—
```bash
# åº”ç”¨æ—¥å¿—
tail -f /opt/ai-stack/logs/app.log

# Nginxè®¿é—®æ—¥å¿—
tail -f /var/log/nginx/access.log

# ç³»ç»Ÿæ—¥å¿—
journalctl -u ai-stack -f
```

#### 2. é‡å¯æœåŠ¡
```bash
# Dockeræ–¹å¼
docker-compose restart

# Systemdæ–¹å¼
sudo systemctl restart ai-stack

# æ‰‹åŠ¨æ–¹å¼
# æ‰¾åˆ°è¿›ç¨‹å¹¶é‡å¯
pkill -f "uvicorn api.app"
gunicorn api.app:app ...
```

#### 3. æ•°æ®åº“ç»´æŠ¤
```bash
# PostgreSQL vacuum
psql -d aistack -c "VACUUM ANALYZE;"

# æ£€æŸ¥æ•°æ®åº“å¤§å°
psql -d aistack -c "SELECT pg_size_pretty(pg_database_size('aistack'));"
```

### ç‰ˆæœ¬æ›´æ–°

#### æ›´æ–°åˆ°æ–°ç‰ˆæœ¬
```bash
# 1. å¤‡ä»½æ•°æ®
/opt/ai-stack/scripts/backup_all.sh

# 2. æ‹‰å–æ–°ä»£ç 
cd /opt/ai-stack
git fetch origin
git checkout v2.6.0  # æ–°ç‰ˆæœ¬æ ‡ç­¾

# 3. æ›´æ–°ä¾èµ–
source venv/bin/activate
pip install -r requirements.txt --upgrade

# 4. æ•°æ®åº“è¿ç§»
python3 scripts/migrate_database.py

# 5. é‡å¯æœåŠ¡
docker-compose restart
# æˆ–
sudo systemctl restart ai-stack

# 6. éªŒè¯
curl http://localhost:8000/health
```

---

## âš ï¸ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
sudo lsof -i :8000

# æ£€æŸ¥ä¾èµ–
pip check

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
python3 -m uvicorn api.app:app --log-level debug
```

#### 2. æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
psql -h localhost -U user -d aistack

# æ£€æŸ¥DATABASE_URLé…ç½®
cat .env | grep DATABASE_URL

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
sudo journalctl -u postgresql -f
```

#### 3. æ€§èƒ½é—®é¢˜
```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨
htop

# æŸ¥çœ‹æ•°æ®åº“æ…¢æŸ¥è¯¢
psql -d aistack -c "SELECT * FROM pg_stat_statements ORDER BY total_time DESC LIMIT 10;"

# æ£€æŸ¥Redis
redis-cli ping
redis-cli info memory
```

#### 4. æ–‡ä»¶ä¸Šä¼ å¤±è´¥
```bash
# æ£€æŸ¥å­˜å‚¨ç©ºé—´
df -h

# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /opt/ai-stack/uploads

# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t
```

---

## ğŸ“ æ”¯æŒä¸å›æ»š

### è·å–æ”¯æŒ
- æŸ¥çœ‹æ–‡æ¡£ï¼š`/opt/ai-stack/docs/`
- æŸ¥çœ‹æ—¥å¿—ï¼š`/opt/ai-stack/logs/`
- é—®é¢˜æŠ¥å‘Šï¼šåˆ›å»ºGitHub Issue

### å›æ»šæ–¹æ¡ˆ

#### å¿«é€Ÿå›æ»š
```bash
# 1. åˆ‡æ¢åˆ°æ—§ç‰ˆæœ¬
cd /opt/ai-stack
git checkout v2.5.0

# 2. æ¢å¤ä¾èµ–
pip install -r requirements.txt

# 3. æ¢å¤æ•°æ®åº“ï¼ˆå¦‚æœæœ‰å˜æ›´ï¼‰
psql -d aistack < /opt/backups/aistack_backup_YYYYMMDD.sql

# 4. é‡å¯æœåŠ¡
docker-compose restart
```

---

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

### æœ€ç»ˆéªŒè¯

- [ ] âœ… æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] âœ… å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] âœ… æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡
- [ ] âœ… SSLè¯ä¹¦é…ç½®æ­£ç¡®
- [ ] âœ… é˜²ç«å¢™è§„åˆ™æ­£ç¡®
- [ ] âœ… ç›‘æ§é…ç½®å®Œæˆ
- [ ] âœ… å¤‡ä»½ç­–ç•¥é…ç½®
- [ ] âœ… æ—¥å¿—è½®è½¬é…ç½®
- [ ] âœ… æ€§èƒ½åŸºå‡†è¾¾æ ‡
- [ ] âœ… æ–‡æ¡£æ›´æ–°å®Œæˆ

### ç§»äº¤ä¿¡æ¯

**æœåŠ¡å™¨ä¿¡æ¯**:
- IPåœ°å€ï¼š________________
- åŸŸåï¼š________________
- SSHç”¨æˆ·ï¼š________________

**è®¿é—®ä¿¡æ¯**:
- åº”ç”¨URLï¼š________________
- ç®¡ç†å‘˜è´¦å·ï¼š________________
- åˆå§‹å¯†ç ï¼š________________

**ç›‘æ§ä¿¡æ¯**:
- å¥åº·æ£€æŸ¥ï¼š________________
- æ—¥å¿—ä½ç½®ï¼š________________
- å‘Šè­¦è”ç³»ï¼š________________

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

æ‚¨å·²æˆåŠŸéƒ¨ç½²AI Stack v2.5.0æ ¸å¿ƒæ¨¡å—ï¼š

- âœ… **å®‰å…¨ç³»ç»Ÿ** - 100%æµ‹è¯•é€šè¿‡
- âœ… **OpenWebUIé›†æˆ** - 100%æµ‹è¯•é€šè¿‡
- âœ… **RAGæ–‡ä»¶å¤„ç†** - 87%æµ‹è¯•é€šè¿‡

**ä¸‹ä¸€æ­¥**:
1. ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
2. æ”¶é›†ç”¨æˆ·åé¦ˆ
3. å‡†å¤‡v2.6.0å¢å¼ºåŠŸèƒ½

---

**éƒ¨ç½²æ—¥æœŸ**: ________________  
**éƒ¨ç½²äººå‘˜**: ________________  
**éªŒè¯äººå‘˜**: ________________

**ç¥è¿è¡Œé¡ºåˆ©ï¼** ğŸš€

