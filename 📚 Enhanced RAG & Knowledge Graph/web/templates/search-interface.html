<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êô∫ËÉΩÊêúÁ¥¢ - AI StackË∂ÖÁ∫ßÂ¢ûÂº∫Áâà</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/rag-enhanced.css') }}">
    <style>
        .search-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .search-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .search-main {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .search-input-group {
            position: relative;
            margin-bottom: 30px;
        }

        .search-input {
            width: 100%;
            padding: 20px 60px 20px 30px;
            font-size: 18px;
            border: 2px solid #e1e5e9;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .search-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #0056b3;
        }

        .search-options {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-option {
            background: #f8f9fa;
            border: 1px solid #e1e5e9;
            border-radius: 20px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .search-option.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }

        .filters-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            margin-bottom: 15px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .filter-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .search-results {
            margin-top: 30px;
        }

        .results-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
        }

        .results-count {
            color: #6c757d;
        }

        .sort-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .result-item {
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .result-item:hover {
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.1);
        }

        .result-header {
            display: flex;
            justify-content: between;
            align-items: start;
            margin-bottom: 10px;
        }

        .result-title {
            font-size: 18px;
            font-weight: 600;
            color: #007bff;
            margin: 0;
        }

        .result-source {
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: #6c757d;
        }

        .result-preview {
            color: #495057;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .result-meta {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #6c757d;
        }

        .highlight {
            background: #fff3cd;
            padding: 0 2px;
            border-radius: 2px;
        }

        .confidence-score {
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .confidence-bar {
            width: 60px;
            height: 4px;
            background: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: #28a745;
            transition: width 0.3s ease;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }

        .page-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }

        .page-btn:hover:not(.active) {
            background: #f8f9fa;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .suggestions {
            margin-top: 20px;
        }

        .suggestion-title {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .suggestion-list {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .suggestion-item {
            background: #e7f1ff;
            color: #007bff;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-item:hover {
            background: #007bff;
            color: white;
        }

        .loading-indicator {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .advanced-search-toggle {
            text-align: center;
            margin: 10px 0;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: #007bff;
            cursor: pointer;
            font-size: 14px;
        }

        .related-concepts {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .concepts-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .concepts-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .concept-tag {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 15px;
            padding: 4px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .concept-tag:hover {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
    </style>
</head>
<body>
    <div class="search-container">
        <!-- ÊêúÁ¥¢Â§¥ÈÉ® -->
        <div class="search-header">
            <h1>Êô∫ËÉΩËØ≠‰πâÊêúÁ¥¢</h1>
            <p>Âü∫‰∫éAI StackË∂ÖÁ∫ßÂ¢ûÂº∫ÁâàÁöÑRAGÂíåÁü•ËØÜÂõæË∞±ÊäÄÊúØ</p>
        </div>

        <!-- ‰∏ªË¶ÅÊêúÁ¥¢Âå∫Âüü -->
        <div class="search-main">
            <!-- ÊêúÁ¥¢ËæìÂÖ• -->
            <div class="search-input-group">
                <input type="text" id="search-query" class="search-input" placeholder="ËæìÂÖ•ÊÇ®Ë¶ÅÊêúÁ¥¢ÁöÑÂÜÖÂÆπ..." autocomplete="off">
                <button id="search-button" class="search-btn">
                    <span style="font-size: 18px;">üîç</span>
                </button>
            </div>

            <!-- ÊêúÁ¥¢ÈÄâÈ°π -->
            <div class="search-options">
                <div class="search-option active" data-scope="all">ÂÖ®ÈÉ®ÂÜÖÂÆπ</div>
                <div class="search-option" data-scope="documents">ÊñáÊ°£</div>
                <div class="search-option" data-scope="images">ÂõæÁâá</div>
                <div class="search-option" data-scope="audio">Èü≥È¢ë</div>
                <div class="search-option" data-scope="video">ËßÜÈ¢ë</div>
                <div class="search-option" data-scope="knowledge">Áü•ËØÜÂõæË∞±</div>
            </div>

            <!-- È´òÁ∫ßÊêúÁ¥¢ÂàáÊç¢ -->
            <div class="advanced-search-toggle">
                <button class="toggle-btn" id="toggle-advanced-search">
                    + È´òÁ∫ßÊêúÁ¥¢ÈÄâÈ°π
                </button>
            </div>

            <!-- È´òÁ∫ßÊêúÁ¥¢Èù¢Êùø -->
            <div id="advanced-search-panel" class="filters-panel hidden">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="filter-group">
                        <label for="file-type">Êñá‰ª∂Á±ªÂûã</label>
                        <select id="file-type" class="filter-select">
                            <option value="">ÊâÄÊúâÁ±ªÂûã</option>
                            <option value="pdf">PDFÊñáÊ°£</option>
                            <option value="doc">WordÊñáÊ°£</option>
                            <option value="ppt">ÊºîÁ§∫ÊñáÁ®ø</option>
                            <option value="image">ÂõæÁâáÊñá‰ª∂</option>
                            <option value="audio">Èü≥È¢ëÊñá‰ª∂</option>
                            <option value="video">ËßÜÈ¢ëÊñá‰ª∂</option>
                            <option value="code">‰ª£Á†ÅÊñá‰ª∂</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="date-range">Êó∂Èó¥ËåÉÂõ¥</label>
                        <select id="date-range" class="filter-select">
                            <option value="">ÊâÄÊúâÊó∂Èó¥</option>
                            <option value="today">‰ªäÂ§©</option>
                            <option value="week">Êú¨Âë®</option>
                            <option value="month">Êú¨Êúà</option>
                            <option value="year">‰ªäÂπ¥</option>
                            <option value="custom">Ëá™ÂÆö‰πâ</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="confidence-threshold">ÁΩÆ‰ø°Â∫¶ÈòàÂÄº</label>
                        <input type="range" id="confidence-threshold" min="0" max="100" value="80" class="filter-select">
                        <span id="confidence-value">80%</span>
                    </div>

                    <div class="filter-group">
                        <label for="sort-by">ÊéíÂ∫èÊñπÂºè</label>
                        <select id="sort-by" class="filter-select">
                            <option value="relevance">Áõ∏ÂÖ≥ÊÄß</option>
                            <option value="date-desc">ÊúÄÊñ∞‰ºòÂÖà</option>
                            <option value="date-asc">ÊúÄÊóß‰ºòÂÖà</option>
                            <option value="confidence">ÁΩÆ‰ø°Â∫¶</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- ÊêúÁ¥¢Âª∫ËÆÆ -->
            <div id="search-suggestions" class="suggestions hidden">
                <div class="suggestion-title">ÊêúÁ¥¢Âª∫ËÆÆÔºö</div>
                <div class="suggestion-list" id="suggestion-list"></div>
            </div>
        </div>

        <!-- ÊêúÁ¥¢ÁªìÊûú -->
        <div class="search-results">
            <div class="results-header">
                <div class="results-count" id="results-count">ËØ∑ËæìÂÖ•ÊêúÁ¥¢ËØç</div>
                <div class="sort-options hidden" id="sort-options">
                    <span>ÊéíÂ∫è:</span>
                    <select id="results-sort">
                        <option value="relevance">Áõ∏ÂÖ≥ÊÄß</option>
                        <option value="date">Êó•Êúü</option>
                        <option value="confidence">ÁΩÆ‰ø°Â∫¶</option>
                    </select>
                </div>
            </div>

            <!-- ÊêúÁ¥¢ÁªìÊûúÂàóË°® -->
            <div id="results-list">
                <div class="no-results">
                    <div style="font-size: 48px; margin-bottom: 20px;">üîç</div>
                    <h3>ÂºÄÂßãÊêúÁ¥¢</h3>
                    <p>‰ΩøÁî®‰∏äÊñπÁöÑÊêúÁ¥¢Ê°ÜÊü•ÊâæÊÇ®ÈúÄË¶ÅÁöÑ‰ø°ÊÅØ</p>
                </div>
            </div>

            <!-- Âä†ËΩΩÊåáÁ§∫Âô® -->
            <div id="loading-indicator" class="loading-indicator hidden">
                <div class="spinner"></div>
                <p>Ê≠£Âú®ÊêúÁ¥¢‰∏≠...</p>
            </div>

            <!-- Áõ∏ÂÖ≥Ê¶ÇÂøµ -->
            <div id="related-concepts" class="related-concepts hidden">
                <div class="concepts-title">Áõ∏ÂÖ≥Ê¶ÇÂøµÔºö</div>
                <div class="concepts-list" id="concepts-list"></div>
            </div>

            <!-- ÂàÜÈ°µ -->
            <div class="pagination hidden" id="pagination">
                <button class="page-btn" id="prev-page">‰∏ä‰∏ÄÈ°µ</button>
                <div id="page-numbers"></div>
                <button class="page-btn" id="next-page">‰∏ã‰∏ÄÈ°µ</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/real-time-search.js') }}"></script>
    <script>
        // ÊêúÁ¥¢ÁïåÈù¢‰∫§‰∫íÈÄªËæë
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('search-query');
            const searchButton = document.getElementById('search-button');
            const searchOptions = document.querySelectorAll('.search-option');
            const advancedSearchPanel = document.getElementById('advanced-search-panel');
            const toggleAdvancedBtn = document.getElementById('toggle-advanced-search');
            const confidenceSlider = document.getElementById('confidence-threshold');
            const confidenceValue = document.getElementById('confidence-value');

            // ÊêúÁ¥¢ÈÄâÈ°πÂàáÊç¢
            searchOptions.forEach(option => {
                option.addEventListener('click', function() {
                    searchOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // È´òÁ∫ßÊêúÁ¥¢ÂàáÊç¢
            toggleAdvancedBtn.addEventListener('click', function() {
                advancedSearchPanel.classList.toggle('hidden');
                this.textContent = advancedSearchPanel.classList.contains('hidden')
                    ? '+ È´òÁ∫ßÊêúÁ¥¢ÈÄâÈ°π'
                    : '- ÈöêËóèÈ´òÁ∫ßÈÄâÈ°π';
            });

            // ÁΩÆ‰ø°Â∫¶ÊªëÂùó
            confidenceSlider.addEventListener('input', function() {
                confidenceValue.textContent = this.value + '%';
            });

            // ÊêúÁ¥¢ÂäüËÉΩ
            searchButton.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            function performSearch() {
                const query = searchInput.value.trim();
                if (query) {
                    // ÊòæÁ§∫Âä†ËΩΩÊåáÁ§∫Âô®
                    document.getElementById('loading-indicator').classList.remove('hidden');
                    document.getElementById('results-list').innerHTML = '';

                    // Ê®°ÊãüÊêúÁ¥¢ËøáÁ®ã
                    setTimeout(() => {
                        displaySearchResults(query);
                    }, 1000);
                }
            }

            function displaySearchResults(query) {
                // ËøôÈáåÂ∫îËØ•Ë∞ÉÁî®ÂÆûÈôÖÁöÑÊêúÁ¥¢API
                // ÁõÆÂâç‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ
                const resultsList = document.getElementById('results-list');
                const resultsCount = document.getElementById('results-count');
                const sortOptions = document.getElementById('sort-options');
                const pagination = document.getElementById('pagination');
                const relatedConcepts = document.getElementById('related-concepts');

                // ÊòæÁ§∫ÁªìÊûúËÆ°Êï∞ÂíåÊéß‰ª∂
                resultsCount.textContent = `ÊâæÂà∞ 15 ‰∏™Áõ∏ÂÖ≥ÁªìÊûú (ÊêúÁ¥¢ËØç: "${query}")`;
                sortOptions.classList.remove('hidden');
                pagination.classList.remove('hidden');
                relatedConcepts.classList.remove('hidden');

                // ÈöêËóèÂä†ËΩΩÊåáÁ§∫Âô®
                document.getElementById('loading-indicator').classList.add('hidden');

                // ÊòæÁ§∫Ê®°ÊãüÁªìÊûú
                resultsList.innerHTML = `
                    <div class="result-item">
                        <div class="result-header">
                            <h3 class="result-title">AI StackË∂ÖÁ∫ßÂ¢ûÂº∫ÁâàÂºÄÂèëÊñáÊ°£</h3>
                            <span class="result-source">PDFÊñáÊ°£</span>
                        </div>
                        <div class="result-preview">
                            Êú¨ÊñáÊ°£ËØ¶ÁªÜ‰ªãÁªç‰∫Ü<mark class="highlight">AI StackË∂ÖÁ∫ßÂ¢ûÂº∫Áâà</mark>ÁöÑÁ≥ªÁªüÊû∂ÊûÑ„ÄÅÂäüËÉΩÊ®°ÂùóÂíåÊäÄÊúØÂÆûÁé∞ÁªÜËäÇ„ÄÇÂåÖÂê´RAGÁ≥ªÁªü„ÄÅÁü•ËØÜÂõæË∞±„ÄÅÊñá‰ª∂ÁÆ°ÁêÜÁ≠âÊ†∏ÂøÉÁªÑ‰ª∂ÁöÑÂÆåÊï¥ËØ¥Êòé„ÄÇ
                        </div>
                        <div class="result-meta">
                            <span>‰øÆÊîπÊó∂Èó¥: 2024-01-15</span>
                            <span>Êñá‰ª∂Â§ßÂ∞è: 2.3 MB</span>
                            <span class="confidence-score">
                                ÁΩÆ‰ø°Â∫¶:
                                <div class="confidence-bar">
                                    <div class="confidence-fill" style="width: 95%"></div>
                                </div>
                                95%
                            </span>
                        </div>
                    </div>

                    <div class="result-item">
                        <div class="result-header">
                            <h3 class="result-title">Áü•ËØÜÂõæË∞±ÊûÑÂª∫ÊåáÂçó</h3>
                            <span class="result-source">Áü•ËØÜÂ∫ìÊù°ÁõÆ</span>
                        </div>
                        <div class="result-preview">
                            Â¶Ç‰ΩïÊûÑÂª∫ÂíåÁª¥Êä§‰ºÅ‰∏öÁ∫ß<mark class="highlight">Áü•ËØÜÂõæË∞±</mark>ÔºåÂåÖÊã¨ÂÆû‰ΩìËØÜÂà´„ÄÅÂÖ≥Á≥ªÊäΩÂèñ„ÄÅÂõæË∞±Â≠òÂÇ®ÂíåÂèØËßÜÂåñÁ≠âÂÖ≥ÈîÆÊäÄÊúØ„ÄÇ
                        </div>
                        <div class="result-meta">
                            <span>Êõ¥Êñ∞Êó∂Èó¥: 2024-01-14</span>
                            <span>Êù•Ê∫ê: ÂÜÖÈÉ®Áü•ËØÜÂ∫ì</span>
                            <span class="confidence-score">
                                ÁΩÆ‰ø°Â∫¶:
                                <div class="confidence-bar">
                                    <div class="confidence-fill" style="width: 88%"></div>
                                </div>
                                88%
                            </span>
                        </div>
                    </div>
                `;

                // ÊòæÁ§∫Áõ∏ÂÖ≥Ê¶ÇÂøµ
                document.getElementById('concepts-list').innerHTML = `
                    <div class="concept-tag">RAGÁ≥ªÁªü</div>
                    <div class="concept-tag">ÂêëÈáèÊï∞ÊçÆÂ∫ì</div>
                    <div class="concept-tag">ËØ≠‰πâÊêúÁ¥¢</div>
                    <div class="concept-tag">ÂÆû‰ΩìËØÜÂà´</div>
                    <div class="concept-tag">ÂÖ≥Á≥ªÊäΩÂèñ</div>
                `;
            }
        });
    </script>
</body>
</html>