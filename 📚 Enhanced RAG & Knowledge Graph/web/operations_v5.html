<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¿è¥ç®¡ç† V5.0 - AI-STACK</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #2563eb; --success: #10b981; --warning: #f59e0b; --error: #ef4444;
            --bg: #0f172a; --surface: #1e293b; --text: #f1f5f9; --text-sec: #94a3b8; --border: #334155;
        }
        body { font-family: Inter, -apple-system, sans-serif; background: var(--bg); color: var(--text); }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .top-nav { background: var(--surface); padding: 1rem 2rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .nav-title { font-size: 1.5rem; font-weight: 600; }
        .back-btn { background: var(--primary); border: none; color: white; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer; }
        .tabs { display: flex; gap: 0.5rem; background: var(--surface); padding: 1rem; border-radius: 12px; margin-bottom: 1.5rem; }
        .tab { padding: 0.75rem 1.5rem; background: transparent; border: none; color: var(--text-sec); cursor: pointer; border-radius: 8px; transition: all 0.2s; }
        .tab.active { background: var(--primary); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .metric-card { background: var(--surface); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border); }
        .metric-label { color: var(--text-sec); font-size: 0.9rem; margin-bottom: 0.5rem; }
        .metric-value { font-size: 2rem; font-weight: 700; }
        .chart-container { background: var(--surface); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border); margin-bottom: 1.5rem; }
        .chart-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; }
        .chart-wrapper { position: relative; height: 300px; }
        .data-table { background: var(--surface); border-radius: 12px; border: 1px solid var(--border); }
        .table-header { padding: 1rem; background: #334155; display: flex; justify-content: space-between; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--border); }
        th { color: var(--text-sec); font-weight: 600; font-size: 0.9rem; }
        .btn { padding: 0.6rem 1.2rem; border-radius: 8px; border: none; cursor: pointer; background: var(--primary); color: white; }
    </style>
</head>
<body>
    <div class="top-nav">
        <div class="nav-title">âš™ï¸ è¿è¥ç®¡ç† V5.0</div>
        <button class="back-btn" onclick="window.history.back()">â† è¿”å›</button>
    </div>
    <div class="container">
        <div class="tabs">
            <button class="tab active" data-tab="dashboard">ğŸ“Š æ•°æ®çœ‹æ¿</button>
            <button class="tab" data-tab="process">ğŸ”„ æµç¨‹ç®¡ç†</button>
            <button class="tab" data-tab="users">ğŸ‘¥ ç”¨æˆ·åˆ†æ</button>
            <button class="tab" data-tab="campaigns">ğŸ“¢ æ´»åŠ¨ç®¡ç†</button>
        </div>
        
        <div class="tab-content active" id="dashboard">
            <div class="card-grid">
                <div class="metric-card"><div class="metric-label">æ—¥æ´»ç”¨æˆ·</div><div class="metric-value">12,345</div></div>
                <div class="metric-card"><div class="metric-label">è½¬åŒ–ç‡</div><div class="metric-value">8.5%</div></div>
                <div class="metric-card"><div class="metric-label">å®¢å•ä»·</div><div class="metric-value">Â¥456</div></div>
                <div class="metric-card"><div class="metric-label">ç•™å­˜ç‡</div><div class="metric-value">72%</div></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">ğŸ“ˆ ç”¨æˆ·å¢é•¿è¶‹åŠ¿</div>
                <div class="chart-wrapper"><canvas id="chart1"></canvas></div>
            </div>
        </div>
        
        <div class="tab-content" id="process">
            <div class="data-table">
                <div class="table-header"><div>ğŸ”„ ä¸šåŠ¡æµç¨‹åˆ—è¡¨</div><button class="btn">ä¼˜åŒ–å»ºè®®</button></div>
                <table><thead><tr><th>æµç¨‹åç§°</th><th>æ‰§è¡Œæ¬¡æ•°</th><th>å¹³å‡æ—¶é•¿</th><th>æˆåŠŸç‡</th></tr></thead>
                <tbody>
                    <tr><td>ç”¨æˆ·æ³¨å†Œæµç¨‹</td><td>1,234</td><td>2.3åˆ†é’Ÿ</td><td>95%</td></tr>
                    <tr><td>è®¢å•å¤„ç†æµç¨‹</td><td>856</td><td>5.1åˆ†é’Ÿ</td><td>98%</td></tr>
                </tbody></table>
            </div>
        </div>
        
        <div class="tab-content" id="users">
            <div class="chart-container">
                <div class="chart-title">ğŸ‘¥ ç”¨æˆ·è¡Œä¸ºåˆ†æ</div>
                <div class="chart-wrapper"><canvas id="chart2"></canvas></div>
            </div>
        </div>
        
        <div class="tab-content" id="campaigns">
            <div class="data-table">
                <div class="table-header"><div>ğŸ“¢ æ´»åŠ¨åˆ—è¡¨</div><button class="btn">åˆ›å»ºæ´»åŠ¨</button></div>
                <table><thead><tr><th>æ´»åŠ¨åç§°</th><th>å¼€å§‹æ—¶é—´</th><th>å‚ä¸äººæ•°</th><th>è½¬åŒ–ç‡</th></tr></thead>
                <tbody>
                    <tr><td>åŒåä¸€å¤§ä¿ƒ</td><td>2025-11-11</td><td>5,678</td><td>12.3%</td></tr>
                </tbody></table>
            </div>
        </div>
    </div>
    <script>
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab, .tab-content').forEach(el => el.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });
        const ctx1 = document.getElementById('chart1').getContext('2d');
        new Chart(ctx1, {
            type: 'line',
            data: { labels: ['å‘¨ä¸€','å‘¨äºŒ','å‘¨ä¸‰','å‘¨å››','å‘¨äº”','å‘¨å…­','å‘¨æ—¥'], datasets: [{
                label: 'æ—¥æ´»', data: [8000,8500,9200,10100,11200,13400,12345], borderColor: '#10b981', tension: 0.4
            }]},
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: '#f1f5f9' }}},
                scales: { y: { ticks: { color: '#94a3b8' }, grid: { color: '#334155' }}, x: { ticks: { color: '#94a3b8' }, grid: { color: '#334155' }}}
            }
        });
        
        // ==================== åç«¯APIè¿æ¥ï¼ˆV5.6ï¼‰====================
        
        async function loadOperationsData() {
            try {
                console.log('ğŸ“¡ åŠ è½½è¿è¥æ•°æ®...');
                const response = await fetch('/api/v5/operations/kpi/dashboard');
                if (response.ok) {
                    const data = await response.json();
                    console.log('âœ… è¿è¥æ•°æ®åŠ è½½æˆåŠŸ', data);
                    
                    // æ›´æ–°KPIæŒ‡æ ‡
                    if (data.daily_active_users) {
                        document.querySelector('.metric-card:nth-child(1) .metric-value').textContent = 
                            data.daily_active_users.toLocaleString();
                    }
                    if (data.conversion_rate) {
                        document.querySelector('.metric-card:nth-child(2) .metric-value').textContent = 
                            data.conversion_rate + '%';
                    }
                }
            } catch (error) {
                console.warn('âš ï¸  è¿è¥APIæœªå°±ç»ªï¼Œä½¿ç”¨æ¼”ç¤ºæ•°æ®:', error.message);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è·å–æ•°æ®
        window.addEventListener('load', loadOperationsData);
        
        console.log('âœ… è¿è¥ç®¡ç†V5ç•Œé¢å·²åŠ è½½ï¼ˆV5.6åç«¯è¿æ¥ç‰ˆï¼‰');
    </script>
</body>
</html>

