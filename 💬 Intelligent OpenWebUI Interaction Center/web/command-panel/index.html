<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Stack å‘½ä»¤é¢æ¿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .header h1 {
            color: white;
            font-size: 28px;
            margin-bottom: 8px;
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .command-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .command-card {
            background: #16213e;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #0f3460;
        }

        .command-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .command-card .icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .command-card .title {
            font-size: 16px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
        }

        .command-card .desc {
            font-size: 13px;
            color: #aaa;
        }

        .result-container {
            background: #16213e;
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid #0f3460;
            display: none;
        }

        .result-container.show {
            display: block;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #0f3460;
        }

        .result-header h2 {
            color: #667eea;
            font-size: 20px;
        }

        .result-content {
            background: #0f1419;
            padding: 20px;
            border-radius: 8px;
            max-height: 500px;
            overflow-y: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .spinner {
            border: 4px solid #0f3460;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .btn-clear {
            background: #f44336;
            color: white;
        }

        .btn-clear:hover {
            background: #d32f2f;
        }

        .custom-command {
            background: #16213e;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #0f3460;
        }

        .custom-command h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .input-group input {
            flex: 1;
            padding: 12px 18px;
            background: #0f1419;
            border: 2px solid #0f3460;
            border-radius: 8px;
            color: #eee;
            font-size: 14px;
            outline: none;
        }

        .input-group input:focus {
            border-color: #667eea;
        }

        .input-group button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .input-group button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .openwebui-link {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.3s;
            margin-right: 10px;
        }

        .openwebui-link:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ AI Stack å‘½ä»¤é¢æ¿</h1>
            <p>å¿«é€Ÿè°ƒç”¨AI Stackæ‰€æœ‰åŠŸèƒ½ - ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æˆ–è¾“å…¥è‡ªå®šä¹‰å‘½ä»¤</p>
        </div>

        <div style="margin-bottom: 20px; text-align: center;">
            <a href="http://localhost:3000" class="openwebui-link" target="_blank">
                ğŸ’¬ æ‰“å¼€ OpenWebUI
            </a>
            <a href="http://localhost:8012" class="openwebui-link" target="_blank">
                ğŸ’¼ æ‰“å¼€ ERPç³»ç»Ÿ
            </a>
        </div>

        <div class="custom-command">
            <h3>ğŸ’¬ è‡ªå®šä¹‰å‘½ä»¤</h3>
            <div class="input-group">
                <input type="text" id="customCommand" placeholder="è¾“å…¥å‘½ä»¤ï¼Œå¦‚ï¼šæŸ¥çœ‹æœ¬æœˆè´¢åŠ¡ã€æœç´¢çŸ¥è¯†åº“ã€æŸ¥çœ‹AAPLè‚¡ç¥¨..." />
                <button onclick="executeCustomCommand()">æ‰§è¡Œ</button>
            </div>
        </div>

        <h2 style="color: #667eea; margin-bottom: 15px;">âš¡ å¿«æ·å‘½ä»¤</h2>

        <div class="command-grid">
            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹æ‰€æœ‰ç³»ç»ŸçŠ¶æ€')">
                <div class="icon">ğŸŒ</div>
                <div class="title">ç³»ç»ŸçŠ¶æ€</div>
                <div class="desc">æŸ¥çœ‹æ‰€æœ‰9ä¸ªç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€</div>
            </div>

            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹ç³»ç»Ÿèµ„æº')">
                <div class="icon">âš™ï¸</div>
                <div class="title">ç³»ç»Ÿèµ„æº</div>
                <div class="desc">æŸ¥çœ‹CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨æƒ…å†µ</div>
            </div>

            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹æœ¬æœˆè´¢åŠ¡')">
                <div class="icon">ğŸ’°</div>
                <div class="title">æœ¬æœˆè´¢åŠ¡</div>
                <div class="desc">æŸ¥çœ‹ERPæœ¬æœˆè´¢åŠ¡çœ‹æ¿æ•°æ®</div>
            </div>

            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹å®¢æˆ·åˆ—è¡¨')">
                <div class="icon">ğŸ‘¥</div>
                <div class="title">å®¢æˆ·åˆ—è¡¨</div>
                <div class="desc">æŸ¥çœ‹ERPå®¢æˆ·ç®¡ç†åˆ—è¡¨</div>
            </div>

            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹çŸ¥è¯†åº“ç»Ÿè®¡')">
                <div class="icon">ğŸ“š</div>
                <div class="title">çŸ¥è¯†åº“</div>
                <div class="desc">æŸ¥çœ‹RAGçŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯</div>
            </div>

            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹è¿è¡Œä¸­çš„ä»»åŠ¡')">
                <div class="icon">ğŸ¤–</div>
                <div class="title">è¿è¡Œä»»åŠ¡</div>
                <div class="desc">æŸ¥çœ‹ä»»åŠ¡ä»£ç†ç³»ç»Ÿä¸­çš„æ´»è·ƒä»»åŠ¡</div>
            </div>

            <div class="command-card" onclick="executeCommand('æŸ¥çœ‹AAPLè‚¡ç¥¨')">
                <div class="icon">ğŸ“ˆ</div>
                <div class="title">è‚¡ç¥¨è¡Œæƒ…</div>
                <div class="desc">æŸ¥çœ‹AAPLè‚¡ç¥¨å®æ—¶è¡Œæƒ…</div>
            </div>

            <div class="command-card" onclick="executeCommand('ç³»ç»Ÿè¿è¡Œæƒ…å†µ')">
                <div class="icon">ğŸ§ </div>
                <div class="title">ç³»ç»Ÿåˆ†æ</div>
                <div class="desc">è·å–ç³»ç»Ÿè‡ªæˆ‘åˆ†ææŠ¥å‘Š</div>
            </div>

            <div class="command-card" onclick="executeCommand('å¸®åŠ©')">
                <div class="icon">â“</div>
                <div class="title">å¸®åŠ©</div>
                <div class="desc">æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤åˆ—è¡¨</div>
            </div>
        </div>

        <div class="result-container" id="resultContainer">
            <div class="result-header">
                <h2>ğŸ“Š æ‰§è¡Œç»“æœ</h2>
                <button class="btn btn-clear" onclick="clearResult()">æ¸…é™¤</button>
            </div>
            <div class="result-content" id="resultContent"></div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8020';

        async function executeCommand(command) {
            showLoading();
            
            try {
                const response = await fetch(
                    `${API_URL}/execute?command=${encodeURIComponent(command)}`,
                    { timeout: 10000 }
                );
                
                const data = await response.json();
                displayResult(command, data);
            } catch (error) {
                displayError(command, error.message);
            }
        }

        async function executeCustomCommand() {
            const command = document.getElementById('customCommand').value.trim();
            if (!command) {
                alert('è¯·è¾“å…¥å‘½ä»¤');
                return;
            }
            
            await executeCommand(command);
        }

        function showLoading() {
            const container = document.getElementById('resultContainer');
            const content = document.getElementById('resultContent');
            
            container.classList.add('show');
            content.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <div>æ‰§è¡Œä¸­...</div>
                </div>
            `;
        }

        function displayResult(command, data) {
            const content = document.getElementById('resultContent');
            
            let html = `<div style="color: #667eea; margin-bottom: 15px; font-weight: bold;">ğŸ“ å‘½ä»¤: ${command}</div>`;
            
            if (data.error) {
                html += `<div style="color: #f44336;">âŒ é”™è¯¯: ${data.error}</div>`;
            } else {
                html += formatResult(data);
            }
            
            content.innerHTML = html;
        }

        function formatResult(data) {
            let html = '';
            
            // æ ‡é¢˜
            if (data.title) {
                html += `<div style="color: #4facfe; font-size: 18px; margin-bottom: 15px;">${data.title}</div>`;
            }
            
            // ç³»ç»ŸçŠ¶æ€
            if (data.systems) {
                html += '<div style="margin-bottom: 10px;">';
                for (const [name, status] of Object.entries(data.systems)) {
                    html += `<div style="padding: 8px; margin-bottom: 5px; background: #0f1419; border-radius: 5px;">`;
                    html += `<strong>${name}</strong>: ${status}`;
                    html += `</div>`;
                }
                html += '</div>';
                if (data.summary) {
                    html += `<div style="color: #4caf50; margin-top: 10px;">${data.summary}</div>`;
                }
            }
            
            // è´¢åŠ¡æ•°æ®
            if (data.income) {
                html += `<div style="background: #0f1419; padding: 15px; border-radius: 8px; margin-bottom: 10px;">`;
                html += `<div style="margin-bottom: 8px;"><strong>ğŸ’° æ€»æ”¶å…¥:</strong> ${data.income}</div>`;
                html += `<div style="margin-bottom: 8px;"><strong>ğŸ’¸ æ€»æ”¯å‡º:</strong> ${data.expense}</div>`;
                html += `<div style="margin-bottom: 8px;"><strong>ğŸ“ˆ åˆ©æ¶¦:</strong> ${data.profit}</div>`;
                html += `<div><strong>ğŸ“Š åˆ©æ¶¦ç‡:</strong> ${data.profit_margin}</div>`;
                html += `</div>`;
            }
            
            // å®¢æˆ·åˆ—è¡¨
            if (data.customers) {
                html += `<div style="margin-top: 15px;"><strong>å…± ${data.count} ä¸ªå®¢æˆ·:</strong></div>`;
                data.customers.forEach((c, i) => {
                    html += `<div style="padding: 10px; margin-top: 8px; background: #0f1419; border-radius: 5px;">`;
                    html += `${i+1}. <strong>${c.name}</strong> | ${c.category} | ${c.level}`;
                    html += `</div>`;
                });
            }
            
            // RAGç»Ÿè®¡
            if (data.documents !== undefined) {
                html += `<div style="background: #0f1419; padding: 15px; border-radius: 8px;">`;
                html += `<div style="margin-bottom: 8px;"><strong>ğŸ“„ æ–‡æ¡£æ€»æ•°:</strong> ${data.documents}</div>`;
                html += `<div style="margin-bottom: 8px;"><strong>ğŸ§© çŸ¥è¯†å—æ•°:</strong> ${data.chunks}</div>`;
                html += `<div style="margin-bottom: 8px;"><strong>ğŸ” æ£€ç´¢æ¬¡æ•°:</strong> ${data.queries}</div>`;
                html += `<div><strong>ğŸ’¾ å­˜å‚¨å¤§å°:</strong> ${data.storage_mb}</div>`;
                html += `</div>`;
            }
            
            // æœç´¢ç»“æœ
            if (data.results) {
                html += `<div style="margin-top: 15px;"><strong>æ‰¾åˆ° ${data.count} æ¡ç»“æœ:</strong></div>`;
                data.results.forEach((r, i) => {
                    html += `<div style="padding: 15px; margin-top: 10px; background: #0f1419; border-radius: 8px; border-left: 3px solid #667eea;">`;
                    html += `<div style="color: #4facfe; margin-bottom: 8px;"><strong>${i+1}. ç›¸å…³åº¦ ${r.score}</strong></div>`;
                    html += `<div style="margin-bottom: 8px;">${r.content}...</div>`;
                    html += `<div style="color: #888; font-size: 12px;">æ¥æº: ${r.source}</div>`;
                    html += `</div>`;
                });
            }
            
            // å¸®åŠ©ä¿¡æ¯
            if (data.commands) {
                for (const [category, cmds] of Object.entries(data.commands)) {
                    html += `<div style="margin-bottom: 20px;">`;
                    html += `<div style="color: #4facfe; font-size: 16px; margin-bottom: 10px;"><strong>${category}</strong></div>`;
                    cmds.forEach(cmd => {
                        html += `<div style="padding: 8px 12px; margin-bottom: 5px; background: #0f1419; border-radius: 5px; cursor: pointer;" onclick="executeCommand('${cmd}')">`;
                        html += `â€¢ ${cmd}`;
                        html += `</div>`;
                    });
                    html += `</div>`;
                }
            }
            
            // é»˜è®¤JSONæ˜¾ç¤º
            if (!html) {
                html = `<pre style="color: #4caf50;">${JSON.stringify(data, null, 2)}</pre>`;
            }
            
            return html;
        }

        function displayError(command, error) {
            const content = document.getElementById('resultContent');
            content.innerHTML = `
                <div style="color: #667eea; margin-bottom: 15px; font-weight: bold;">ğŸ“ å‘½ä»¤: ${command}</div>
                <div style="color: #f44336; padding: 15px; background: #2d1414; border-radius: 8px;">
                    âŒ é”™è¯¯: ${error}
                    <div style="margin-top: 10px; font-size: 12px; color: #aaa;">
                        æç¤º: è¯·ç¡®ä¿å‘½ä»¤ç½‘å…³æœåŠ¡æ­£åœ¨è¿è¡Œ (ç«¯å£8020)
                    </div>
                </div>
            `;
        }

        function clearResult() {
            document.getElementById('resultContainer').classList.remove('show');
        }

        // å›è½¦æ‰§è¡Œ
        document.getElementById('customCommand').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                executeCustomCommand();
            }
        });
    </script>
</body>
</html>


